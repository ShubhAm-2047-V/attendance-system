<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My Attendance</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body class="dashboard-bg">

<div class="attendance-card">

    <!-- Header -->
    <div class="attendance-header">
        <h2>ðŸ‘‹ Hi {{ current_user.username }}</h2>
        <p>Your attendance overview</p>
    </div>

    <!-- ðŸ”” Notifications (today only already handled in backend) -->
    {% if notifications %}
    <div style="margin-bottom:16px;">
        <h4>Notifications</h4>
        {% for n in notifications %}
            <div style="background:#fee2e2;padding:8px 10px;border-radius:10px;margin-bottom:8px;">
                {{ n.message }}
            </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- ðŸ“Š Stats -->
    <div class="summary-row">
        <div class="summary present">
            Present<br>
            <strong>{{ present_count }}</strong>
        </div>

        <div class="summary absent">
            Absent<br>
            <strong>{{ absent_count }}</strong>
        </div>
    </div>

    <div class="summary-row">
        <div class="summary present">
            ðŸ”¥ Streak<br>
            <strong>{{ streak }}</strong> days
        </div>
    </div>

    <!-- ðŸ“‹ Attendance List -->
    <div class="table-wrapper">
        <table class="attendance-table">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for row in records %}
                {% set is_today = row.date == today %}

                <tr style="{% if is_today %}background:#f0fdf4;{% endif %}">
                    <td>
                        {{ row.date.strftime('%d-%m-%Y') }}
                        {% if is_today %}
                            <span style="
                                margin-left:6px;
                                font-size:11px;
                                background:#22c55e;
                                color:white;
                                padding:2px 8px;
                                border-radius:999px;
                                font-weight:600;
                            ">
                                Today
                            </span>
                        {% endif %}
                    </td>
                    <td>
                        {% if row.status == "Present" %}
                            <span class="status-badge present">Present</span>
                        {% else %}
                            <span class="status-badge absent">Absent</span>
                        {% endif %}
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="2" style="text-align:center;color:#6b7280;">
                        No attendance records yet
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Logout -->
    <a href="{{ url_for('logout') }}" class="logout-btn-full">
        Logout
    </a>

</div>

</body>
</html>
