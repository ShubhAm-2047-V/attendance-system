<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Panel | AttendEase</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body class="dashboard-bg admin-page page-enter">

<div class="admin-container">

    <div class="admin-card">

        <!-- Header -->
        <div class="dashboard-header">
            <h2>Admin Panel</h2>
            <p>Manage users</p>
        </div>

        <!-- Add User -->
        <div class="action-box">
            <a href="{{ url_for('add_user') }}" class="add-user-btn">
                + Add New User
            </a>
            <p class="add-user-subtext">
                Create admin, teacher or student
            </p>
        </div>

        <!-- USERS TABLE -->
        <div class="table-switcher">
            <div class="table-view active" id="users-table">

                <div class="table-wrapper">
                    <table class="attendance-table">
                        <thead>
                            <tr>
                                <th>Username</th>
                                <th>Role</th>
                                <th>Actions</th>
                            </tr>
                        </thead>

                        <tbody>
                            {% for user in users %}
                            <tr>
                                <td>{{ user.username }}</td>

                                <td>
                                    <span class="role-badge role-{{ user.role }}">
                                        {{ user.role }}
                                    </span>

                                    {% if not user.is_active %}
                                        <span class="role-badge role-admin">
                                            Locked
                                        </span>
                                    {% endif %}
                                </td>

                                <td>
                                    {% if user.id != current_user.id %}
                                        <a href="{{ url_for('toggle_user', user_id=user.id) }}"
                                           class="action-btn action-edit">
                                            {{ 'Lock' if user.is_active else 'Unlock' }}
                                        </a>

                                        <a href="{{ url_for('delete_user', user_id=user.id) }}"
                                           class="action-btn action-delete"
                                           onclick="return confirm('Delete this user?')">
                                            Delete
                                        </a>
                                    {% else %}
                                        â€”
                                    {% endif %}
                                </td>
                            </tr>
                            {% else %}
                            <tr>
                                <td colspan="3" class="empty-row">
                                    No users found
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>

                <!-- PAGINATION -->
                {% if pagination and pagination.pages > 1 %}
                <div class="pagination-box">

                    {% if pagination.has_prev %}
                        <a href="{{ url_for('admin', page=pagination.prev_num) }}"
                           class="page-btn">Prev</a>
                    {% endif %}

                    {% for p in range(1, pagination.pages + 1) %}
                        <a href="{{ url_for('admin', page=p) }}"
                           class="page-btn {% if p == pagination.page %}active{% endif %}">
                            {{ p }}
                        </a>
                    {% endfor %}

                    {% if pagination.has_next %}
                        <a href="{{ url_for('admin', page=pagination.next_num) }}"
                           class="page-btn">Next</a>
                    {% endif %}

                </div>
                {% endif %}

            </div>
        </div>

        <!-- Logout -->
        <div class="logout-box">
            <a href="{{ url_for('logout') }}" class="logout-btn">
                Logout
            </a>
        </div>

    </div>

</div>

</body>
</html>
