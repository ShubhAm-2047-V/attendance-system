<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Panel | AttendEase</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body class="dashboard-bg admin-page page-enter">

<div class="admin-container">

    <div class="admin-card">

        <!-- Header -->
        <div class="dashboard-header">
            <h2>Admin Panel</h2>
            <p>Manage users</p>
        </div>

        <!-- Add User -->
        <a href="{{ url_for('add_user') }}" class="action-card add-user-card">
            <h3>+ Add New User</h3>
            <p>Create admin, teacher or student</p>
        </a>

        <!-- TABLE SWITCHER (IMPORTANT STRUCTURE) -->
        <div class="table-switcher">

            <!-- USERS TABLE -->
            <div class="table-view active" id="users-table">
                <div class="table-wrapper">
                    <table class="attendance-table">
                        <thead>
                            <tr>
                                <th>Username</th>
                                <th>Role</th>
                                <th>Actions</th>
                            </tr>
                        </thead>

                        <tbody>
                            {% for user in users %}
                            <tr>
                                <td>{{ user.username }}</td>

                                <td>
                                    <span class="role-badge role-{{ user.role }}">
                                        {{ user.role }}
                                    </span>

                                    {% if not user.is_active %}
                                        <span class="role-badge role-admin">
                                            Locked
                                        </span>
                                    {% endif %}
                                </td>

                                <td>
                                    {% if user.id != current_user.id %}
                                        <a href="{{ url_for('toggle_user', user_id=user.id) }}"
                                           class="action-btn action-edit">
                                            {{ 'Lock' if user.is_active else 'Unlock' }}
                                        </a>

                                        <a href="{{ url_for('delete_user', user_id=user.id) }}"
                                           class="action-btn action-delete"
                                           onclick="return confirm('Delete this user?')">
                                            Delete
                                        </a>
                                    {% else %}
                                        â€”
                                    {% endif %}
                                </td>
                            </tr>

                            {% else %}
                            <tr>
                                <td colspan="3" class="empty-row">
                                    No users found
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- FUTURE TABLE PLACEHOLDER (animation ready) -->
            <div class="table-view" id="other-table">
                <!-- add another table here later -->
            </div>

        </div>

        <!-- Logout -->
        <a href="{{ url_for('logout') }}" class="logout-btn-full">
            Logout
        </a>

    </div>

</div>

<!-- TABLE SWITCH SCRIPT -->
<script>
function switchTable(id) {
    const current = document.querySelector('.table-view.active');
    const next = document.getElementById(id);

    if (!next || current === next) return;

    current.classList.add('exit');
    current.classList.remove('active');

    setTimeout(() => {
        current.classList.remove('exit');
        next.classList.add('active');
    }, 400);
}
</script>

</body>
</html>
